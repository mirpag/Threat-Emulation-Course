---
cover: >-
  https://images.unsplash.com/photo-1523961131990-5ea7c61b2107?crop=entropy&cs=srgb&fm=jpg&ixid=MnwxOTcwMjR8MHwxfHNlYXJjaHw0fHx0ZWNofGVufDB8fHx8MTY0NTk5MDg4Mg&ixlib=rb-1.2.1&q=85
coverY: 0
---

# Destructive v. Non-Destructive

Threat emulation can be destructive and non-destructive because the antivirus or EDR tool may block Mimikatz, for example, so it never gets to actually run and execute. As a result, you don't know how Mimikatz will really behave in your organization, if a threat actor is able to bypass or disable your antivirus, or your EDR tool. So you're going to remove or disable your antivirus program and EDR temporarily, because you have to pretend that the threat actor knows how to disable and bypass your defenses.  That has to be assumed because a threat actor may obtain administrative credentials of a user that can disable antivirus or be exempt from some types of policies like application controls with tools like AppLocker.&#x20;

Now the key difference between a pen test and a threat emulation exercise is that you're going to be disabling controls and pretending the threat actor bypasses them. It's really important that you do and understand that. You can disable the antivirus and then you're going to go to the next step of the threat actors behavior and see what that response would be.&#x20;

That is another benefit to threat emulation, which is you're looking at logs adn determining how they will generate alerts if the threat actor behavior is really occurring. Did your control block that style of attack? Yes, that's a good thing. It means that if a threat actor carries out their known behavior, then your multiple layers of controls are actually working as expected. So if they do bypass or disable your antivirus, for example, your EDR tool blocked it. Also, you can examine your logs to determine if an alert was not triggered. If not, then you'd want to look into the application further to determine how to generate alerts if the given action was executed. If it did bypass your antivirus or EDR tool, then your multi-actor authentication on remote systems blocked it. You're just slowly stepping through all the behaviors of the threat actor until you've achieved their goal.  Additionally, you're determining what is and isn't being logged for aanlysis and detection.&#x20;

The destructive versus non-destructive exercises depends on the motivations of the threat group. What is their goal? What are their behaviors when they are within an organization? If you know the threat actor uses a certain type of ransomware, you don't really want to encrypt your documents in your organization. That could disrupt production potentially. If you know that the file is encrypted, and has a specific filename, you can make a copy of that file with the ransomware file extension in your threat emulation exercise. Then see how your controls behave based on that, or what logs are being generated as a result of that action. That's a **non-destructive** way to emulate destructive behavior. It is up to each individual organization how they want to perform the exercise. Destructive exercises are not recommended unless it can be done on a non-production system that functions smilar to a production system.&#x20;

Just like with a real threat actor, if you have 200 computers in your organization, you don't have to test all 200 computers. I would say use a small sample of hosts that have the same operating system and configurations. If you have server 2016 or 2019, put an agent on each one of those and setup a read only domain controller or a temporary domain controller with an agent on it. You can see what kind of information will be retrieved if someone really does attack your Active Directory server.&#x20;

In summary, with a SOC monitoring hundreds of networks, you may not be able to duplicate all threat actor behavior. You could, however, set up an offline network and you would test or run through the threat emulation plan exercise. Then you're extracting all relevant logs and behaviors, so you can create a playbook and then apply that to your SEIM. If you're doing this in an organization, you may want to have an offline network, but have it look and behave like your real network.  What determines the exercises and the hosts to test on comes from threat intell.&#x20;

If you have 200 computers in your network, and your network becomes compromised by threat actors, they're not going to compromise all 200 computers. That's just generally not the behavior. They're going to infect maybe 5% of those systems.  Create emulation exercises that won't disrupt production processes.
